Metadata-Version: 2.4
Name: mortalidad-colombia-2019
Version: 0.1.0
Summary: Visualización interactiva de datos de mortalidad en Colombia para 2019.
Author: Equipo mortalidad-colombia-2019
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: dash>=2.14.0
Requires-Dist: Flask-Caching>=2.0.2
Requires-Dist: gunicorn>=21.2.0
Requires-Dist: openpyxl>=3.1.2
Requires-Dist: pandera>=0.17.0
Requires-Dist: pandas>=2.1.0
Requires-Dist: pyarrow>=15.0.0
Requires-Dist: pydantic-settings>=2.0.3
Requires-Dist: python-dotenv>=1.0.0
Requires-Dist: click>=8.1.7
Provides-Extra: dev
Requires-Dist: mypy>=1.9.0; extra == "dev"
Requires-Dist: pytest>=7.4.0; extra == "dev"
Requires-Dist: pytest-cov>=4.1.0; extra == "dev"
Requires-Dist: ruff>=0.4.0; extra == "dev"
Requires-Dist: black>=24.3.0; extra == "dev"
Requires-Dist: isort>=5.12.0; extra == "dev"
Requires-Dist: pre-commit>=3.6.0; extra == "dev"
Requires-Dist: types-python-dateutil; extra == "dev"

# Mortalidad Colombia 2019

## Introducción del proyecto
Aplicación web desarrollada con Dash para explorar de forma interactiva las estadísticas de mortalidad en Colombia durante 2019. El dashboard prioriza la accesibilidad (roles ARIA, estados `:focus-visible`, indicadores de carga) y el rendimiento mediante cacheo en memoria y exportaciones diferidas a CSV.

## Objetivo
Analizar patrones de mortalidad por territorio, causa y grupo poblacional a partir de las bases públicas del DANE, facilitando la identificación de focos de violencia, estacionalidad y diferencias por sexo o edad.

## Estructura del proyecto
```
├── assets/
│   ├── screenshots/              # Capturas utilizadas en este README
│   └── style.css                 # Estilos personalizados del dashboard
├── data/
│   ├── processed/                # Caché parquet generado por la ingesta
│   └── raw/                      # Coloque aquí los archivos Excel originales
├── scripts/                      # Utilidades para tareas de soporte
├── src/mortalidad/               # Código fuente de la aplicación y CLI
├── tests/                        # Suite de pruebas con pytest y fixtures sintéticos
├── Makefile                      # Automatización de tareas locales
├── docker-compose.yml            # Orquestación de servicios para desarrollo
├── render.yaml                   # Blueprint de despliegue en Render
└── pyproject.toml                # Configuración de dependencias y linters
```

## Requisitos
- Python 3.11 o superior (probado con 3.13)
- Make (GNU)
- Virtualenv o similar (se crea automáticamente con `make dev-install`)
- Docker (opcional, para ejecución contenedorizada)
- Acceso a los archivos del DANE:
  - `NoFetal2019.xlsx`
  - `CodigosDeMuerte.xlsx`
  - `Divipola.xlsx`

## Despliegue en Render
1. Ejecuta `make ingest` y `make validate` en local para generar `data/processed/mortalidad_2019.parquet` y verificar la integridad.
2. Publica el repositorio en GitHub/GitLab. Render detectará el blueprint definido en `render.yaml`.
3. En Render selecciona **New → Blueprint**, elige el repositorio y confirma el servicio web sugerido.
4. Configura las variables de entorno: `ENV=production`, `MAPBOX_TOKEN=pk.xxx`, `DATA_DIR=data/raw`, `CACHE_TIMEOUT=300`.
5. Mantén `autoDeploy: true` para reconstruir ante cada push a `main`. El build ya ejecuta `python -m mortalidad.cli ingest --force` para regenerar el parquet antes de servir el dashboard.
6. Revisa la URL asignada y valida filtros principales; consulta los logs de Render ante cualquier fallo.

## Software
- Python, Dash y Plotly para la capa interactiva.
- Pandas y Pandera para ingesta, transformación y validación de datos.
- Flask-Caching para cacheo en memoria.
- Ruff, Black e isort para formato y linting.
- MyPy para tipado estático.
- Pytest y Coverage para pruebas automatizadas.
- Docker y docker-compose para paridad de entornos.

## Instalación
1. **Clonar el repositorio**
   ```bash
   git clone https://github.com/<usuario>/mortalidad-colombia-2019.git
   cd mortalidad-colombia-2019
   ```
2. **Configurar variables**
   ```bash
   cp .env.example .env
   # Ajusta DATA_DIR, PORT, MAPBOX_TOKEN si aplica
   ```
3. **Añadir datos de entrada**
   Copia los tres archivos Excel del DANE dentro de `data/raw/`. El repositorio ignora esta carpeta, por lo que no se versionan los datos sensibles.
4. **Crear entorno y dependencias**
   ```bash
   make dev-install
   ```
5. **Ejecutar la aplicación**
   ```bash
   make run
   # o
   python -m mortalidad.app
   ```
   La aplicación quedará disponible en `http://localhost:8050`.
6. **Comandos útiles**
   - `make lint`, `make typecheck`, `make test`: linting, mypy y pruebas.
   - `make format`: aplica Black + isort.
   - `python -m mortalidad.cli ingest [--force]`: procesa los Excel y genera el parquet.
   - `python -m mortalidad.cli validate`: valida el esquema con Pandera.
   - `python -m mortalidad.cli serve --host 0.0.0.0 --port 8050`: levanta el servidor Dash desde la CLI.
7. **Hooks de pre-commit**
   Ejecuta `make pre-commit` para instalar los hooks que ejecutan Ruff, Black, isort y detect-secrets antes de cada commit.
8. **Configuración opcional en PyCharm**
   Importa el repositorio y selecciona el intérprete `.venv`. Usa **Run → Edit Configurations… → Import from .run** para cargar las ejecuciones predefinidas (`Dash Server`, `PyTests`, `CLI Ingest`).

## Visualizaciones con explicaciones de los resultados

### Mapa coroplético por departamento
![mapa_departamental.png](./assets/screenshots/mapa_departamental.png)
Resalta los departamentos con mayor concentración. El uso de medias geográficas permite ubicar el centroide aproximado de cada territorio y los datos se actualizan según los filtros seleccionados.

### Serie temporal mensual
![serie_mensual.png](./assets/screenshots/serie_mensual.png)
La gráfica de líneas muestra la evolución mensual de los fallecimientos.

### Ranking de municipios con mayor incidencia
![top_homicidios.png](./assets/screenshots/top_homicidios.png)
El gráfico de barras compara los municipios con más casos etiquetados como `X95`. Permite identificar rápidamente los focos urbanos principales; el botón de exportación genera un CSV para análisis posterior.

### Principales causas de muerte
![tabla_causas.png](./assets/screenshots/tabla_causas.png)
La tabla resume las causas más frecuentes reportadas en el periodo. Además de los códigos CIE-10 se muestra la descripción y el número de casos, lo que facilita detectar si los homicidios predominan frente a otras categorías.

### Distribución por grupo de edad
![distribucion_edad.png](./assets/screenshots/distribucion_edad.png)
El histograma agrupa la mortalidad por rangos etarios del DANE.

### Muertes por sexo y departamento
![sexo_departamento.png](assets/screenshots/sexo_departamento.png)
El diagrama de barras apiladas compara la mortalidad entre hombres y mujeres por departamento. Las categorías están ordenadas para resaltar las brechas de género, permitiendo focalizar políticas diferenciales.


## Resumen de hallazgos

El análisis de mortalidad en Colombia durante 2019 revela patrones importantes tanto en salud pública como en violencia social.
Las principales causas de muerte corresponden a agresiones con armas de fuego y enfermedades respiratorias, reflejando problemas de seguridad y atención médica.
En la distribución por sexo y departamento, los hombres presentan tasas de mortalidad significativamente mayores, concentradas en departamentos como Antioquia, Atlántico, Bogotá D.C. y Valle del Cauca.
El análisis de homicidios (X95) muestra que Santiago de Cali, Medellín y Bogotá D.C. lideran los casos, confirmando la persistencia de violencia urbana.
Por grupo de edad, los extremos de la vida concentran la mayor mortalidad: recién nacidos por causas infecciosas y adultos mayores por enfermedades crónicas.
En la evolución mensual, se evidencian aumentos en marzo, julio y diciembre, posiblemente vinculados a variaciones estacionales o factores sociales.
Finalmente, la distribución geográfica muestra una fuerte concentración en la región Andina, mientras que las zonas amazónicas y de la Orinoquía registran niveles menores, acordes con su densidad poblacional.
